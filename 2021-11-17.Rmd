##  Running and blood sugar (18.10)


 A diabetic wants to know how aerobic exercise affects his
blood sugar. When his blood sugar reaches 170 (mg/dl), he goes out for
a run at a pace of 10 minutes per mile. He runs different distances on
different days. Each time he runs, he measures his blood sugar after
the run. (The preferred blood sugar level is between 80 and 120 on
this scale.) The data are in the file
[link](http://ritsokiguess.site/datafiles/runner.txt).  Our aim is
to predict blood sugar from distance.

To begin:

```{r}
library(tidyverse)
```



(a) Read in the data and display the data frame that you read
in.

Data values separated by a single space: 
 
```{r}
my_url <- "https://ritsokiguess.site/datafiles/runner.txt"
runner <- read_delim(my_url, " ")
runner
```
 
Looks like the data in the file.

(b) Make a scatterplot and add a smooth trend to it.
 
```{r}
ggplot(runner, aes(x = distance, y = blood_sugar)) + geom_point() + geom_smooth()
```

`geom_smooth` without anything else is good here because we don't yet know what kind of trend we have.

(c) Would you say that the relationship between blood sugar and
running distance is approximately linear, or not? It is therefore
reasonable to use a regression of blood sugar on distance? Explain briefly.
 
The smooth trend wiggles a little, but it seems that a downward-sloping line describes the trend well, and 
thus an ordinary linear regression will be good.

(d) Fit a suitable regression, and obtain the regression output.

The usual: `lm`, then `summary`:

```{r}
runner.1 <- lm(blood_sugar ~ distance, data = runner)
summary(runner.1)
```

R-squared is (very) high, and the slope is negative and significantly nonzero, so this is a real and 
downward trend.

Aside: if you were worried that a curve would be better, to accommodate the "wiggle" in the smooth trend, you could try adding a squared term:

```{r}
runner.2 <- lm(blood_sugar ~ distance + I(distance^2), data = runner)
summary(runner.2)
```
 
This is a complete waste of time! The squared term is nowhere near significant, and the increase in R-squared over `runner.1` is almost zero. So we can forget about this model from here on.
 
Aside 2: displaying the `summary` is the old way of looking at regression results, but perfectly good for a human looking at them. The `tidyverse`-style way to do it 
 
```{r}
library(broom)
glance(runner.1) 
tidy(runner.1)
```
 

(e) How would you *interpret* the slope? That is, what is
the slope, and what does that mean about blood sugar and running distance?
 

(f) Is there a (statistically) significant relationship between
running distance and blood sugar? How do you know? Do you find this
surprising, given what you have seen so far? Explain briefly.

let's do residual plots:

```{r}
ggplot(runner.1, aes(x = .fitted, y = .resid)) + geom_point()
```

```{r}
ggplot(runner.1, aes(sample = .resid)) + stat_qq() + stat_qq_line()
```
 

(g) This diabetic is planning to go for a 3-mile run tomorrow
and a 5-mile run the day after. Obtain suitable 95\% intervals that
say what his blood sugar might be after each of these runs. 
 

(h) Which of your two intervals is longer? Does this make
sense? Explain briefly.
 



